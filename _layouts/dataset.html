---
layout: page
pageId: datasets
---

<!-- Prism syntax highlighting for SPARQL examples (loaded only on dataset pages) -->
<link rel="stylesheet" href="{{ '/assets/vendor/prism/prism.css' | relative_url }}">
<script src="{{ '/assets/vendor/prism/prism.js' | relative_url }}"></script>
<!-- Load Turtle first because prism-sparql extends the Turtle grammar -->
<script src="{{ '/assets/vendor/prism/prism-turtle.min.js' | relative_url }}"></script>
<script src="{{ '/assets/vendor/prism/prism-sparql.min.js' | relative_url }}"></script>
<script src="{{ '/assets/js/DatasetsManager.js' | relative_url }}"></script>
<script src="{{ '/assets/js/DatasetIcon.js' | relative_url }}"></script>
{% include datasets-json.html %}

<div id="DatasetDetailView">
    {% assign lang = site.active_lang | default: "en" %}
    {% assign i18n = site.data.i18n.dataset_details[lang] %}

    <article class="inner">
        <header>
            <div id="dataset-icon-container" class="icon" aria-hidden="true"></div>
            {% assign _title = page.dataset.title[lang] | default: page.dataset.title.en | default: page.dataset.title
            %}
            <h2>{{ _title }}</h2>
        </header>
        <div class="link">
            <a href="{{ page.dataset.website }}" class="button-view -externallink" target="_blank">{{ i18n.links_website
                }}</a>
        </div>

        {% assign _desc = page.dataset.description[lang] | default: page.dataset.description.en | default:
        page.dataset.description %}
        <p class="description">{{ _desc }}</p>

        <section class="spec">
            <h3>{{ i18n.spec_title }}</h3>
            <table>
                <tbody>
                    <tr data-row-kind="tags" data-type="tags">
                        <th>{{ i18n.tags }}</th>
                        <td>
                            {% if page.dataset and page.dataset.tags %}
                            {% assign _tags = page.dataset.tags %}
                            {% elsif page.tags %}
                            {% assign _tags = page.tags %}
                            {% else %}
                            {% assign _tags = empty %}
                            {% endif %}
                            <div class="tags-container">
                                {% include tags.html tags=_tags %}
                            </div>
                        </td>
                    </tr>
                    <tr data-row-kind="providers" data-type="string">
                        <th>{{ i18n.provider }}</th>
                        <td>
                            {% assign _providers = page.dataset.providers | default: empty %}
                            <ul>
                                {% for provider in _providers %}
                                {% assign _p_name = provider[lang] | default: provider.en | default: provider.name %}
                                <li>{{ _p_name }}</li>
                                {% endfor %}
                            </ul>
                        </td>
                    </tr>
                    <tr data-row-kind="creators" data-type="string">
                        <th>{{ i18n.creator }}</th>
                        <td>
                            {% assign _creators = page.dataset.creators | default: empty %}
                            <ul>
                                {% for creator in _creators %}
                                {% assign _c_name = creator.name[lang] | default: creator.name.en | default:
                                creator.name %}
                                {% assign _c_aff = creator.affiliation[lang] | default: creator.affiliation.en |
                                default: creator.affiliation %}
                                <li>
                                    {{ _c_name }}{% if _c_aff %}<small>{{ _c_aff }}</small>{% endif %}
                                </li>
                                {% endfor %}
                            </ul>
                        </td>
                    </tr>

                    <tr data-row-kind="issued" data-type="date">
                        <th>{{ i18n.issued }}</th>
                        <td>{{ page.dataset.issued }}</td>
                    </tr>

                    {% if page.dataset.licenses %}
                    <tr data-row-kind="licenses" data-type="string">
                        <th>{{ i18n.licenses }}</th>
                        <td>
                            {% assign _licenses = page.dataset.licenses | default: empty %}
                            <ul>
                                {% for license in _licenses %}
                                <li>
                                    {{ license.name }}{% if license.url %}
                                    <a href="{{ license.url }}" class="external-link">link</a>{%
                                    endif %} {% if license.credit %}<br /><small>{{ license.credit }}</small>{% endif %}
                                </li>
                                {% endfor %}
                            </ul>
                        </td>
                    </tr>
                    {% endif %}

                    {% if page.dataset.version %}
                    <tr data-row-kind="version" data-type="string">
                        <th>{{ i18n.version }}</th>
                        <td>{{ page.dataset.version }}</td>
                    </tr>
                    {% endif %}

                    <tr data-row-kind="downloads" data-type="string">
                        <th>{{ i18n.download }}</th>
                        <td>
                            <a href="https://rdfportal.org/download/{{ page.dataset.id }}">https://rdfportal.org/download/{{
                                page.dataset.id }}</a>
                        </td>
                    </tr>

                    <tr data-row-kind="sparql_endpoint" data-type="string">
                        <th>{{ i18n.endpoint }}</th>
                        <td>
                            <a href="https://rdfportal.org/{{ page.dataset.endpoint }}/sparql"
                                target="_blank">https://rdfportal.org/{{
                                page.dataset.endpoint }}/sparql</a>
                        </td>
                    </tr>
                </tbody>
            </table>
        </section>

        <section class="statistics">
            <h3>{{ i18n.stats_title }}</h3>
            {% assign s = page.dataset.statistics | default: nil %}
            {% if s %}

            <div class="container">
                {% for item in site.data.statistics_labels %}
                {% assign key = item.key %}
                {% assign label = item.label %}
                {% if s[key] %}
                <dl>
                    <dt>{{ label }}</dt>
                    <dd class="stat-num">{{ s[key] }}</dd>
                </dl>
                {% endif %}
                {% endfor %}
            </div>

            {% else %}
            <p class="no-data">{{ i18n.no_stats }}</p>
            {% endif %}
        </section>

        {% if page.dataset.sparql_examples and page.dataset.sparql_examples.size > 0 %}
        <section class="sparqlexamples">
            <h3>{{ i18n.sparql_examples }}</h3>
            <div class="examples">
                {% for example in page.dataset.sparql_examples %}
                <article class="example">
                    <header>
                        <h4>{{ i18n.example_label }} {{ forloop.index }}</h4>
                        <a href="https://rdfportal.org/{{ page.dataset.endpoint }}/sparql?query={{ example | url_encode }}"
                            class="button-view -externallink" target="_blank" rel="noopener noreferrer">
                            {% if lang == 'ja' %}エンドポイントで実行{% else %}Run on Endpoint{% endif %}
                        </a>
                    </header>
                    <div class="code-box">
                        <button class="copycodebutton" type="button" aria-label="Copy SPARQL example">{{
                            i18n.copy_button }}</button>
                        <div class="inner">
                            <pre><code class="language-sparql">{{ example | escape }}</code></pre>
                        </div>
                    </div>
                </article>
                {% endfor %}
            </div>
        </section>
        {% endif %}

        {% if page.dataset.schema_svg %}
        <section class="schemadiagram">
            <h3>{{ i18n.schema_diagram }}</h3>
            {% assign dataset_id = page.dataset.id %}
            {% assign local_rel = '/assets/datasets/' | append: dataset_id | append: '/schema.svg' %}
            <div class="container">
                <img src="{{ local_rel | relative_url }}" alt="Schema diagram for {{ dataset_id }}" />
            </div>
            <div class="modaloverlay">
                <div class="modalcontent">
                    <img src="{{ local_rel | relative_url }}" alt="Schema diagram for {{ dataset_id }}" />
                </div>
            </div>
        </section>
        {% endif %}

    </article>
</div>

{% include dataset-tags-json.html tags=page.dataset.tags %} {% include
dataset-init-script.html container_id='dataset-icon-container'
json_id='dataset-tags-json' size=48 %}


<script>

    function setupSchemaDiagramModal() {
        const schemadiagram = document.querySelector('.schemadiagram');
        if (!schemadiagram) return;

        const schemaImg = schemadiagram.querySelector(':scope > .container > img');
        const modalOverlay = schemadiagram.querySelector('.modaloverlay');

        schemaImg.addEventListener('click', function () {
            // Show modal
            modalOverlay.classList.add('-active');

            // Add a one-time click listener to the overlay to close the modal
            const closeHandler = () => {
                modalOverlay.classList.remove('-active');
                modalOverlay.removeEventListener('click', closeHandler);
            };
            modalOverlay.addEventListener('click', closeHandler);
        });
    }

    function formatNumber(n) {
        if (n === null || n === undefined) return n;
        const num = Number(String(n).replace(/[^0-9\-\.]/g, ""));
        if (isNaN(num)) return n;
        return num.toLocaleString();
    }

    // Setup "Copy" buttons in code boxes
    function setupCopyCodeButtons() {

        const rewriteButtonText = function (btn) {
            btn.classList.add('-copied');
            const old = btn.textContent;
            btn.textContent = 'Copied';
            setTimeout(function () { btn.classList.remove('-copied'); btn.textContent = old; }, 1500);
        };

        document.querySelectorAll('.copycodebutton').forEach(function (btn) {
            btn.addEventListener('click', function () {
                const box = btn.closest('.code-box');
                const codeEl = box.querySelector('pre > code');

                if (!codeEl) return;
                // code text is escaped in HTML; use textContent to get raw query
                const p = navigator.clipboard.writeText(codeEl.textContent || '');
                if (p && p.then) {
                    p.then(function () {
                        rewriteButtonText(btn);
                    }).catch(function () {
                        // ignore
                    });
                } else {
                    // fallback path (sync copy)
                    rewriteButtonText(btn);
                }
            });
        });
    }


    function drawBackground() {
        function svgToDataUri(svg) {
            if (!svg) return "";
            const s = String(svg).replace(/\r\n?/g, "\n").trim();
            try {
                return (
                    "data:image/svg+xml;base64," + btoa(unescape(encodeURIComponent(s)))
                );
            } catch (e) {
                try {
                    return "data:image/svg+xml;utf8," + encodeURIComponent(s);
                } catch (e2) {
                    console.error("svgToDataUri: encoding failed", e2);
                    return "";
                }
            }
        }

        function readTags() {
            try {
                const el = document.getElementById("dataset-tags-json");
                if (!el) return [];
                const txt = el.textContent || el.innerText || "";
                if (!txt) return [];
                return JSON.parse(txt || "[]");
            } catch (e) {
                return [];
            }
        }

        function applyBackground(svg) {
            try {
                const styleId = "global-dataset-icon-style";
                const css =
                    '.global-navigation > .background::before{background-image:url("' +
                    svgToDataUri(svg) +
                    '")}';
                const existing = document.getElementById(styleId);
                if (existing) existing.parentNode.removeChild(existing);
                const s = document.createElement("style");
                s.id = styleId;
                s.textContent = css;
                document.head.appendChild(s);
            } catch (e) {
                console.error("applyBackground failed", e);
            }
        }

        const tags = readTags();
        if (
            !window.DatasetIcon ||
            typeof window.DatasetIcon.createSvg !== "function"
        )
            return false;
        try {
            const svg = window.DatasetIcon.createSvg(tags, 120, {});
            applyBackground(svg);
            return true;
        } catch (e) {
            console.warn("global icon generation failed", e);
            return false;
        }

    }


    document.addEventListener('DOMContentLoaded', function () {

        // Format numbers in .stat-num cells with thousands separators
        document.querySelectorAll('.statistics > .container > dl > dd').forEach(function (td) {
            td.textContent = formatNumber(td.textContent);
        });

        // Setup schema diagram modal functionality
        setupSchemaDiagramModal();

        // Setup "Copy" buttons in code boxes
        setupCopyCodeButtons();

        // Draw dataset icon background in global navigation
        drawBackground();

        // Code syntax highlighting
        try {
            if (window.Prism && typeof window.Prism.highlightAll === 'function') {
                window.Prism.highlightAll();
            }
        } catch (e) {
            /* noop */
        }

    });
</script>